{-# LANGUAGE DeriveGeneric               #-}
{-# LANGUAGE FlexibleContexts            #-}
{-# LANGUAGE FlexibleInstances           #-}
{-# LANGUAGE OverloadedStrings           #-}

{-# OPTIONS_GHC -fno-warn-unused-imports #-}

-- Module      : Network.AWS.STS.Types
-- Copyright   : (c) 2013-2014 Brendan Hay <brendan.g.hay@gmail.com>
-- License     : This Source Code Form is subject to the terms of
--               the Mozilla Public License, v. 2.0.
--               A copy of the MPL can be found in the LICENSE file or
--               you can obtain it at http://mozilla.org/MPL/2.0/.
-- Maintainer  : Brendan Hay <brendan.g.hay@gmail.com>
-- Stability   : experimental
-- Portability : non-portable (GHC extensions)

module Network.AWS.STS.Types where

import Data.ByteString      (ByteString)
import Data.Hashable
import Data.Monoid
import Data.List.NonEmpty
import Data.Text            (Text)
import Data.HashMap.Strict  (HashMap)
import Data.Time
import GHC.Generics         (Generic)
import Network.AWS.Internal hiding (Endpoint, Region, AvailabilityZone)

import Network.AWS.STS.Service

-- | Identifiers for the federated user associated with the credentials (such as
-- arn:aws:sts::123456789012:federated-user/Bob or 123456789012:Bob). You can
-- use the federated user's ARN in your resource policies like in an Amazon S3
-- bucket policy.
data FederatedUser = FederatedUser
    { fuArn :: !Text
      -- ^ The ARN that specifies the federated user that is associated with the
      -- credentials. For more information about ARNs and how to use them in
      -- policies, see Identifiers for IAM Entities in Using IAM.
    , fuFederatedUserId :: !Text
      -- ^ The string that identifies the federated user associated with the
      -- credentials, similar to the unique ID of an IAM user.
    } deriving (Eq, Show, Generic)

instance ToQuery FederatedUser

instance FromXML FederatedUser where
    fromXMLOptions = xmlOptions

instance ToXML FederatedUser where
    toXMLOptions = xmlOptions

-- | The temporary security credentials, which include an access key ID, a
-- secret access key, and a security token.
data Credentials = Credentials
    { cAccessKeyId :: !Text
      -- ^ The access key ID that identifies the temporary security credentials.
    , cExpiration :: !UTCTime
      -- ^ The date on which the current credentials expire.
    , cSecretAccessKey :: !Text
      -- ^ The secret access key that can be used to sign requests.
    , cSessionToken :: !Text
      -- ^ The token that users must pass to the service API to use the temporary
      -- credentials.
    } deriving (Eq, Show, Generic)

instance ToQuery Credentials

instance FromXML Credentials where
    fromXMLOptions = xmlOptions

instance ToXML Credentials where
    toXMLOptions = xmlOptions

-- | The Amazon Resource Name (ARN) and the assumed role ID, which are
-- identifiers that you can use to refer to the resulting temporary security
-- credentials. For example, you can reference these credentials as a
-- principal in a resource-based policy by using the ARN or assumed role ID.
-- The ARN and ID include the RoleSessionName that you specified when you
-- called AssumeRole.
data AssumedRoleUser = AssumedRoleUser
    { aruArn :: !Text
      -- ^ The ARN of the temporary security credentials that are returned from the
      -- AssumeRole action. For more information about ARNs and how to use them in
      -- policies, see Identifiers for IAM Entities in Using IAM.
    , aruAssumedRoleId :: !Text
      -- ^ A unique identifier that contains the role ID and the role session name of
      -- the role that is being assumed. The role ID is generated by AWS when the
      -- role is created.
    } deriving (Eq, Show, Generic)

instance ToQuery AssumedRoleUser

instance FromXML AssumedRoleUser where
    fromXMLOptions = xmlOptions

instance ToXML AssumedRoleUser where
    toXMLOptions = xmlOptions
